public class Solution {
    public bool CheckValidGrid(int[][] grid) {
        int[][] dir = new int[][]{[1, 2], [1, -2], [-1, 2], [-1, -2], [2, 1], [-2, 1], [2, -1], [-2, -1]};
        int[] pre = [0, 0];
        int n = grid.Length;
        if(n == 0)
            return true;

        if(grid[0][0] != 0)
            return false;

        int cnt = 0;
        while(cnt < n*n-1)
        {
            int x = pre[0], y = pre[1];
            cnt++;
            int[] next = [-1, -1];
            for(int i = 0; i < dir.Length; i++)
            {
                int newX = x + dir[i][0], newY = y + dir[i][1];
                if(newX >= 0 && newY >= 0 && newX < n && newY < n && grid[newX][newY] == cnt)
                {
                    next = [newX, newY];
                    break;
                }
            }

            if(next[0] == -1)
                return false;

            pre[0] = next[0];
            pre[1] = next[1];
        }

        return true;
    }
}
