public class Solution {
    public string DiscountPrices(string s, int d) 
    {
        StringBuilder sbRes = new StringBuilder();
        int i = 0;

        for (i = 0; i < s.Length; ++i)
        {
            if (s[i] == ' ')
            {
                sbRes.Append(' ');
                continue;
            }

            StringBuilder word = new StringBuilder();
            while (i < s.Length && s[i] != ' ')
            {
                word.Append(s[i]);
                ++i;
            }
            --i;

            if (IsPrice(word))
            {
                word = DiscountPrice(word, d);
            }
            sbRes.Append(word);
        }

        return sbRes.ToString();
    }

    private bool IsPrice(StringBuilder word)
    {
        if (word[0] != '$') return false;
        if (word.Length == 1) return false;
        for (int i = 1; i < word.Length; ++i)
        {
            if (!Char.IsDigit(word[i])) return false;
        }
        return true;
    }

    private StringBuilder DiscountPrice(StringBuilder price, int discount)
    {
        StringBuilder newPrice = new StringBuilder();
        double priceValue = 0.0;

        for (int i = 1; i < price.Length; ++i)
        {
            priceValue = priceValue * 10 + (price[i] - '0');
        }
        priceValue = priceValue * (100 - discount) / 100;
        newPrice.Append("$");
        newPrice.Append(priceValue.ToString("F2"));
        return newPrice;
    }
}
