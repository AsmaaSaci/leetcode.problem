public class Solution {
    public long[] MostFrequentIDs(int[] nums, int[] freq) {
         List<long> ans = new List<long>();
        int n = nums.Length;
        PriorityQueue<long,long> pq = new PriorityQueue<long,long>(Comparer<long>.Create((x,y)=>y.CompareTo(x)));
        Dictionary<long,long> dict = new Dictionary<long,long>();


     for(int i =0; i < n;i++){
        if(dict.ContainsKey(nums[i])){
            dict[nums[i]]+= freq[i];
        }else{
             dict[nums[i]] = freq[i];
         }

         pq.Enqueue(nums[i], dict[nums[i]]);


         while(true){
            pq.TryPeek(out long val, out long ptval);

            if(ptval == dict[val]){
                ans.Add(ptval);
                break;
            } else{
                pq.Dequeue();
            }
         }
     }

     return ans.ToArray();

    }
}
