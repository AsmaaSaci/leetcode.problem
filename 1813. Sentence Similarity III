public class Solution {
    public bool AreSentencesSimilar(string sentence1, string sentence2) {
        // Command 1: Split both input strings into arrays of words
        string[] words1 = sentence1.Split(' ');
        string[] words2 = sentence2.Split(' ');

        // Command 2: If both sentences are identical, return true immediately
        if (Enumerable.SequenceEqual(words1, words2)) return true;

        // Command 3: Initialize empty lists for common prefixes and suffixes
        // Also get the lengths of both sentences for easier reference
        List<string> prefix = new List<string>();
        List<string> suffix = new List<string>();
        int n = words1.Length, m = words2.Length;

        // Command 4: Find common prefix (matching words from the beginning)
        for (int i = 0; i < Math.Min(n, m); i++) {
            if (words1[i] == words2[i]) {
                prefix.Add(words1[i]);
            } else {
                break;
            }
        }

        // Command 5: Find common suffix (matching words from the end)
        for (int i = 0; i < Math.Min(n, m); i++) {
            if (words1[n - i - 1] == words2[m - i - 1]) {
                suffix.Add(words1[n - i - 1]);
            } else {
                break;
            }
        }

        // Command 6: Reverse the suffix to get correct word order
        suffix.Reverse();

        // Command 7: Handle overlap between prefix and suffix
        // If combined length is greater than shorter sentence,
        // there might be overlap
        while (suffix.Count + prefix.Count > Math.Min(n, m)) {
            if (suffix.Count > 0 && prefix.Count > 0 && suffix[0] == prefix[prefix.Count - 1]) {
                prefix.RemoveAt(prefix.Count - 1);
            } else {
                break;
            }
        }

        // Command 8: Combine prefix and suffix into one list
        prefix.AddRange(suffix);

        // Command 9: Check if the combined prefix+suffix equals either original sentence
        return Enumerable.SequenceEqual(prefix, words1) || Enumerable.SequenceEqual(prefix, words2);
    }
}
