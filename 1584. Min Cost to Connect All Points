public class Solution {
    public static int ManhattanDistance(int[] p1, int[] p2) {
        return Math.Abs(p1[0] - p2[0]) + Math.Abs(p1[1] - p2[1]);
    }

    public int MinCostConnectPoints(int[][] points) {
        int n = points.Length;
        bool[] visited = new bool[n];
        Dictionary<int, int> heapDict = new Dictionary<int, int>() { {0, 0} };
        var minHeap = new SortedSet<(int w, int u)>() { (0, 0) };

        int mstWeight = 0;

        while (minHeap.Count > 0) {
            var (w, u) = minHeap.Min;
            minHeap.Remove(minHeap.Min);
            
            if (visited[u] || heapDict[u] < w) continue;

            visited[u] = true;
            mstWeight += w;

            for (int v = 0; v < n; v++) {
                if (!visited[v]) {
                    int newDistance = ManhattanDistance(points[u], points[v]);
                    if (newDistance < heapDict.GetValueOrDefault(v, int.MaxValue)) {
                        heapDict[v] = newDistance;
                        minHeap.Add((newDistance, v));
                    }
                }
            }
        }

        return mstWeight;
    }
}
