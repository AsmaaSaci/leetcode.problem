public class Solution {
    public int ConcatenatedBinary(int n) {
        int size = (int)Math.Log(100000,2)+1, mod = (int)Math.Pow(10,9)+7;
        long res = 0;
        for(int cur = 1; cur <= n; cur++)
        {
            int sample = 1, digs = size;
            while(digs >= 0 && ((cur & (sample << digs)) == 0))
            {
                digs--;
            }

            res <<= (digs+1);
            res += cur;
            res %= mod;
        }

        return (int)res;
    }
}
