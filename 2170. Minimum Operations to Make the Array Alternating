public class Solution {
    public int MinimumOperations(int[] nums) {
        int len = nums.Length;
        if(len < 2) // corner case
            return 0;

        Dictionary<int, int[]> freq = new(); // Count number frequency by even/odd index
        for(int i = 0; i < len; i++)
        {
            int cur = nums[i];
            int id = i%2;
            if(!freq.ContainsKey(cur))
                freq.Add(cur, new int[2]);

            freq[cur][id]++;
        }

        int[][] arr = freq.Values.ToArray();
        int aLen = arr.Length;
        int[] tailMax = new int[aLen]; // Store largest frequency on right side

        for(int i = aLen-2; i >= 0; i--)
        {
            tailMax[i] = Math.Max(arr[i+1][1], tailMax[i+1]);
        }

        int keepCnt = 0, preMax = 0;

        for(int i = 0; i < aLen; i++)
        {
            int otherMax = Math.Max(preMax,tailMax[i]);
            keepCnt = Math.Max(keepCnt, otherMax+arr[i][0]);
            preMax = Math.Max(preMax, arr[i][1]);
        }

        return len-keepCnt;
    }
}
