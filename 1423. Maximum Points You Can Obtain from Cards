public class Solution {
    public int MaxScore(int[] cardPoints, int k)
    {
        if (k == 0)
            return 0;

        int n = cardPoints.Length;
        int window = 0;

        // Sum the first k cards
        for (int i = 0; i < k; i++)
            window += cardPoints[i];

        int result = window;

        // Sliding window: replace left cards with right cards
        for (int i = 0; i < k; i++)
        {
            window -= cardPoints[k - i - 1];   // remove from left
            window += cardPoints[n - i - 1];   // add from right

            result = Math.Max(result, window);
        }

        return result;
    }
}
