public class Solution
{
    public long[] GetDistances(int[] arr)
    {
        int n = arr.Length;
        Dictionary<int, List<int>> positionMap = new Dictionary<int, List<int>>();
        for (int i = 0; i < n; i++)
        {
            if (!positionMap.ContainsKey(arr[i]))
            {
                positionMap[arr[i]] = new List<int>();
            }

            positionMap[arr[i]].Add(i);
        }

        long[] ans = new long[n];
        foreach(List<int> list in positionMap.Values)
        {
            long[] preSums = new long[list.Count + 1];
            for(int i = 0; i < list.Count; i++)
            {
                preSums[i + 1] = preSums[i] + list[i];
            }

            for(int i = 0; i < list.Count; i++)
            {
                long v = list[i];
                // pre
                ans[v] = v * (i+1) - preSums[i+1];
                // post
                ans[v] += preSums[list.Count] - preSums[i] - v * (list.Count - i);
            }
        }

        return ans;
    }
}
