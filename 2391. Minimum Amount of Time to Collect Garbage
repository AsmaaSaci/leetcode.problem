public class Solution {
    public int GarbageCollection(string[] garbage, int[] travel) {
       int[] prefixSum = new int[travel.Length + 1];
        prefixSum[1] = travel[0];
        
        for (int i = 1; i < travel.Length; i++) {
            prefixSum[i + 1] = prefixSum[i] + travel[i];
        }

        Dictionary<char, int> garbageLastPos = new Dictionary<char, int>();
        Dictionary<char, int> garbageCount = new Dictionary<char, int>();
        
        for (int i = 0; i < garbage.Length; i++) {
            foreach (char c in garbage[i].ToCharArray()) {
                garbageLastPos[c] = i;
                if (!garbageCount.ContainsKey(c)) {
                    garbageCount[c] = 1;
                } else {
                    garbageCount[c]++;
                }
            }
        }

        string garbageTypes = "MPG";
        int ans = 0;
        
        foreach (char c in garbageTypes.ToCharArray()) {
            if (garbageCount.ContainsKey(c)) {
                ans += (prefixSum[garbageLastPos[c]] + garbageCount[c]);
            }
        }

        return ans;
    }
}
