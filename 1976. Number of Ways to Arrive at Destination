public class Solution {
    public int CountPaths(int n, int[][] roads) {
        List<(int, int)>[] graph = new List<(int, int)>[n];
        for (int i = 0; i < n; i++) graph[i] = new List<(int, int)>();

        foreach (var road in roads) {
            int u = road[0], v = road[1], time = road[2];
            graph[u].Add((v, time));
            graph[v].Add((u, time));
        }

        long[] dist = new long[n];
        int[] ways = new int[n];
        Array.Fill(dist, long.MaxValue);
        Array.Fill(ways, 0);

        dist[0] = 0;
        ways[0] = 1;
        int MOD = 1_000_000_007;

        PriorityQueue<(long d, int v), (long d, int v)> pq = new();
        pq.Enqueue((0, 0), (0, 0));

        while (pq.Count > 0) {
            var (d, node) = pq.Dequeue();
            if (d > dist[node])
            {
                continue;
            }
            
            foreach (var (neighbor, time) in graph[node]) {
                if (dist[node] + time < dist[neighbor]) {
                    dist[neighbor] = dist[node] + time;
                    ways[neighbor] = ways[node];
                    pq.Enqueue((dist[neighbor], neighbor), (dist[neighbor], neighbor));
                } else if (dist[node] + time == dist[neighbor]) {
                    ways[neighbor] = (ways[neighbor] + ways[node]) % MOD;
                }
            }
        }

        return ways[n - 1];
    }
}
