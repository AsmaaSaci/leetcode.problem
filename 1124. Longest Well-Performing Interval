public class Solution {
    public int LongestWPI(int[] hours) {
        int n = hours.Length;
        Dictionary<int, int> map = new Dictionary<int, int>();
        hours[0] = hours[0] > 8 ? 1 : -1;
        map[hours[0]] = 0;
        int ans = 0;
        for(int i = 1; i < n; i++)
            hours[i] = hours[i - 1] + (hours[i] > 8 ? 1 : -1);

        for(int i = 0; i < n; i++) {
            if(hours[i] > 0)
                ans = i + 1;
            else {
                if(map.ContainsKey(hours[i] - 1)) {
                    int left = map[hours[i] - 1];
                    ans = Math.Max(ans, i - left);
                }
                if(!map.ContainsKey(hours[i]))
                    map[hours[i]] = i;
            }
        }
        return ans;
    }
}
