class Solution {
public:
    vector<string> invalidTransactions(vector<string>& transactions) {
        vector<string> name;
        int m = transactions.size();
        vector<int> time;
        vector<int> amount;
        vector<string> city;
        for(auto s:transactions){
            string n, t, a, c;
            // stringstream ss(s);
            // getline(ss, n, ',');
            // getline(ss, t, ',');
            // getline(ss, a, ',');
            // getline(ss, c, ',');
            int p1 = s.find(',');
            int p2 = s.find(',', p1+1);
            int p3 = s.find(',', p2+1);
            n = s.substr(0, p1);
            t = s.substr(p1+1, p2 - p1 - 1);
            a = s.substr(p2+1, p3 - p2 - 1);
            c = s.substr(p3+1);
            name.push_back(n);
            time.push_back(stoi(t));
            amount.push_back(stoi(a));
            city.push_back(c);
        }
        vector<bool> invalid(m, false);
        for(int i=0;i<m;i++){
            if(amount[i]>1000) invalid[i] = true;
            for(int j=0;j<m;j++){
                if(i==j) continue;
                if(name[i]==name[j] && city[i]!=city[j] && abs(time[i]-time[j])<=60){
                    invalid[i] = true;
                    break;
                }
            }
        }
        vector<string> ans;
        for(int i=0;i<m;i++){
            if(invalid[i]) ans.push_back(transactions[i]);
        }
        return ans;
    }
};
